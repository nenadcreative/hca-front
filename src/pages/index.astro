---
import fetchApi from "../lib/strapi";
import type Home from "../interfaces/home";
import Layout from "../layouts/Layout.astro";
import DecoratedText from "../components/DecoratedText.tsx";
import RenderSections from "../components/RenderSections.astro";
import "../styles/base.css";

import qs from "qs";
const query = qs.stringify(
  {
    populate: {
      sections: {
        populate: "*",
      },
    },
  },

  {
    encodeValuesOnly: false, // prettify URL
  }
);

const homequery = `home?${query}`;

const homeData = await fetchApi<Home>({
  endpoint: homequery, // the content type to fetch
  wrappedByKey: "data", // the key to unwrap the response
});

console.log(homeData.attributes.sections);
---

<Layout title="Home">
  <RenderSections content={homeData.attributes.sections} />
</Layout>
